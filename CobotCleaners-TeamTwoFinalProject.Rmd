---
title: "ETM 640 Team 2 Final Project"
author: "Team 2"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library (magrittr, quietly = TRUE) #Used for pipes/dplyr
library (dplyr, quietly = TRUE)
library (ROI, quietly = TRUE)
library (ROI.plugin.glpk, quietly = TRUE)
library (ompr, quietly = TRUE)
library (ompr.roi, quietly = TRUE)
library (pander, quietly = TRUE)
```

## Team Members

- Christopher Davis
- Brandon Iwasaki
- Taban Yolo
- Niss Lagah

## Final Paper

[Click here](https://docs.google.com/document/d/14RsYIWRkcGrVW3ZvBQ0Zhixd4qoAOTht5TTymMF9xBg/edit) to check out our final paper.

Code for this project is in [GitHub](https://github.com/cwhd/cobot-operations)

## Abstract

Robots are becoming cheaper to build and cobotics (collaborative robotics) are creating new business opportunities. The home cleaning market is projected to reach $33 billion b 2022 and is an ideal scenario for cobot cleaning services. This paper explores the opportunity from an operations research perspective to determine the ideal configurataion to determine how to package robots together for maximum profitibility, explore which types of robots to invest in based on tarket markets, and the best way to transport them around.

## Scenarios

### Scenario 1

- We have 6 packages, we need to determine which is most profitable

To do this we will set the profitibility of each package, and which robots are in each package. 
maximize profit
decision variables: 6 packages
constraints: number of each type of robot

## Scenario 2

- Use sensitivity analysis to determine where to invest next

from the first scenario we should know what relative profitability is for each robot. We can then look at the shadow pricing (from week 3) to determine which robots are contributing the most to profitibility and therefore where to invest to grow the company.

## Scenario 3

- Finally we will do the transportation problem so that we can determine which van to send to which neighborhood


We would like to determine which cobots to invest in to maximize growth while minimizing overhead. Their target market includes houses in planned neighborhoods and apartments with known configurations, so we should be able to project which cobots need to be built or configured to meet an estimated demand. Ideally we would like to find apartment complexes or neighborhoods that we can work in where we can optimize our investments, finding the ideal number of robots based on real estate data should help us do this.

### Robot Information

Different configurations of robots are needed for each house or apartment that needs to get clean. For example, if a house has stairs it needs a special sweeper that can move up and down stairs, a special robot is used to clean sinks so the number of sinks can effect the number of robots needed and the time it takes to clean. The following robots and their constraints are available:

Vaccum Robot: Cleans 400 square feet in 30 minutes with a battery life of 2 hours. Can only clean one level of a house at a time, so if there is more than one floor you may need more. This works best on hardwood floors.

Carpet Robot: Specially designed to clean carpets. Can clean 350 square feet in 30 minutes with a battery life of 2 hours.

Duster Drone: Used to fly around the perimiter of a house to dust corners and shelves. Can cover 1200 square feet in 15 minutes and has a battery life of 30 minutes.

Stair Cleaner: Cleans a typcial staircase in 7 minutes, has 2 hour battery life.

Toilet Cleaner: Cleans a toilet in 5 minutes, has a battery life of 2 hours

Sink Cleaner: Cleans a sink in 5 minutes, has a battery life of 2 hours

The following table shows the data for each robot, including cost.

```{r}
robotData<-read.csv(file="RobotData.csv") #load the data
print(paste0(nrow(robotData), " rows"))
print(paste0(ncol(robotData), " columns"))
pander (robotData, caption="Robot Data")

```

- Take out carpet cleaner
- Figure out what profit looks like

min cost robots 


Talk about stuff more here...

And here is data for the locations we will be cleaning:

```{r}
customerLocationData<-read.csv(file="CustomerLocationData.csv") #load the data
print(paste0(nrow(customerLocationData), " rows"))
print(paste0(ncol(customerLocationData), " columns"))
pander (customerLocationData, caption="Customer Location Data")

```

## Cleaning Rules:

- We need to vaccum the entire floor
- A duster drone needs to cover the entire square foot area
- Every toilet and sink must be cleaned
- Goal oriented - Hotel scenario
 - 

## Mixing resources

Maybe this just needs to be like the matrix in week 2.
The products are the mix of robots, or what we need to clean a specific house. They would be made up of several different robots. 

The resources are the number of robots needed to do the work

So translate the following block to robots and stuff!

```{r}
NProd <- 4
NResources <- 5

ProdNames <- lapply(list(rep("Config",NProd)),paste0,1:NProd) 
                 # Product names: Prod1, Prod2, ... 

ResNames<- lapply(list(rep("Robot",NResources)),paste0,1:NResources) 
                 # Resource names: Res1, Res2, ... 

Profit <- matrix(c(20, 14, 3, 16), 
              ncol=NProd,dimnames=c("Profit",ProdNames))

Resources <- matrix(c( 6, 8, 6, 7 , 40, 2, 6, 4, 10, 25, 1, 1, 1, 2, 5, 4, 8, 25, 12, 16), 
              ncol=NProd,dimnames=c(ResNames,ProdNames))

Available <- matrix(c(1440, 1440, 2000, 1000, 9600), 
              ncol=1,dimnames=c(ResNames,"Available"))

pander(Resources, caption="Resources used by each product")

pander (Available, caption="Amount of each Resource Available")

```

Talk about it here

I think we should have a model to create the configuration, then a table to show what configuration is ideal

and more here

```{r}

prodmodel <- MIPModel() %>%
  add_variable (x[i], i=1:NProd, type="continuous", lb=0) %>%
  set_objective (sum_expr(Profit[i] * x[i] , i=1:NProd ), "max") %>%
  add_constraint (sum_expr(Resources[j,i]*x[i], i=1:NProd) # Left hand side of constraint
                  <= Available[j],    # Inequality and Right side of constraint
                  j=1:NResources) %>% # Repeat for each resource, j.  
  solve_model(with_ROI(solver = "glpk"))
  
prodmodel
results.products <- matrix (rep(-1.0,NProd), nrow = NProd, ncol=1,
                            dimnames=c(ProdNames,c("x")))

temp <- get_solution (prodmodel, x[i]) # Extracts optimal values of variables   
results.products <- t(temp [,3] )      # Extracts third column

results.products <- matrix (results.products, nrow = 1, ncol=NProd,
                            dimnames=c(c("x"),ProdNames))  
                                       # Resizes and renames 

pander (results.products, caption = "Optimal Production Plan")

```

